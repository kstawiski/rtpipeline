{"record_format_version": 6, "code": "        import subprocess\n        job_threads = max(1, threads)\n        sentinel_path = Path(output.sentinel)\n        sentinel_path.parent.mkdir(parents=True, exist_ok=True)\n        log_path = Path(log[0])\n        log_path.parent.mkdir(parents=True, exist_ok=True)\n        env = _rt_env()\n        cmd = [\n            sys.executable,\n            \"-m\",\n            \"rtpipeline.cli\",\n            \"--dicom-root\", str(DICOM_ROOT),\n            \"--outdir\", str(OUTPUT_DIR),\n            \"--logs\", str(LOGS_DIR),\n            \"--stage\", \"dvh\",\n            \"--course-filter\", f\"{wildcards.patient}/{wildcards.course}\",\n        cmd.extend(_max_worker_args(job_threads))\n        if CUSTOM_STRUCTURES_CONFIG:\n            cmd.extend([\"--custom-structures\", CUSTOM_STRUCTURES_CONFIG])\n        with log_path.open(\"w\") as logf:\n        with log_path.open(\"w\") as logf:\n            subprocess.run(cmd, check=True, stdout=logf, stderr=subprocess.STDOUT, env=env)\n        sentinel_path.write_text(\"ok\\n\", encoding=\"utf-8\")\n", "rule": "dvh_course", "input": ["/data/output/416435/2018-09/.crop_ct_done", "/data/output/416435/2018-09/.custom_models_done", "/data/output/416435/2018-09/.segmentation_done", "/data/output/_COURSES/manifest.json"], "log": ["/data/logs/dvh/416435_2018-09.log"], "params": [], "shellcmd": null, "incomplete": false, "starttime": null, "endtime": 1764077718.7148411, "job_hash": 8280610980277, "conda_env": null, "software_stack_hash": "d41d8cd98f00b204e9800998ecf8427e", "container_img_url": null, "input_checksums": {"/data/output/_COURSES/manifest.json": "bc7a0a848986b386ece1525e7b608ffd77dd3163ffbce6a8a4f476889a09a922", "/data/output/416435/2018-09/.segmentation_done": "dc51b8c96c2d745df3bd5590d990230a482fd247123599548e0632fdbf97fc22", "/data/output/416435/2018-09/.custom_models_done": "dc51b8c96c2d745df3bd5590d990230a482fd247123599548e0632fdbf97fc22", "/data/output/416435/2018-09/.crop_ct_done": "dc51b8c96c2d745df3bd5590d990230a482fd247123599548e0632fdbf97fc22"}}
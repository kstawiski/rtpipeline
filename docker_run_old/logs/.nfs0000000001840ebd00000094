2025-11-24 09:36:27,993 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:36:28,887 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:36:28,887 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:36:28,887 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:36:28,887 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:36:28,887 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:36:28,887 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:36:28,887 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:36:29,455 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 09:36:30,139 [INFO] rtpipeline.organize: Using RD.416435.ET1 rap.dcm as reference dose grid (finest resolution)
2025-11-24 09:36:39,327 [INFO] rtpipeline.segmentation: Running dcm2niix: dcm2niix -z y -o /data/output/480007/2024-08/NIFTI/.tmp_dcm2niix /data/output/480007/2024-08/DICOM/CT
2025-11-24 09:36:40,030 [INFO] rtpipeline.segmentation: Running dcm2niix: dcm2niix -z y -o /data/output/480008/2024-09/NIFTI/.tmp_dcm2niix /data/output/480008/2024-09/DICOM/CT
2025-11-24 09:36:43,698 [INFO] rtpipeline.segmentation: Running dcm2niix: dcm2niix -z y -o /data/output/416435/2018-09/NIFTI/.tmp_dcm2niix /data/output/416435/2018-09/DICOM/CT
2025-11-24 09:36:43,883 [INFO] rtpipeline.segmentation: Running dcm2niix: dcm2niix -z y -o /data/output/487009/2025-09/NIFTI/.tmp_dcm2niix /data/output/487009/2025-09/DICOM/CT
2025-11-24 09:36:44,187 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 14.7s ETA 73.7s
2025-11-24 09:36:45,651 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 16.2s ETA 32.4s
2025-11-24 09:36:45,952 [INFO] rtpipeline.segmentation: Running dcm2niix: dcm2niix -z y -o /data/output/428459/2019-11/NIFTI/.tmp_dcm2niix /data/output/428459/2019-11/DICOM/CT
2025-11-24 09:36:47,144 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 17.7s ETA 17.7s
2025-11-24 09:36:50,843 [INFO] rtpipeline.segmentation: Running dcm2niix: dcm2niix -z y -o /data/output/487009/2025-03/NIFTI/.tmp_dcm2niix /data/output/487009/2025-03/DICOM/CT
2025-11-24 09:36:51,118 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 21.7s ETA 10.8s
2025-11-24 09:36:51,728 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 22.3s ETA 4.5s
2025-11-24 09:36:57,536 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 28.1s ETA 0.0s
2025-11-24 09:36:57,543 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:36:57,543 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:36:57,543 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:36:57,543 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:36:57,543 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:36:57,543 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:37:03,328 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:37:03,609 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:37:03,610 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:37:15,921 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:37:26,090 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:37:37,560 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:38:21,140 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:38:59,965 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:39:52,690 [INFO] rtpipeline.meta: Exported metadata to /data/output/Data
2025-11-24 09:40:06,122 [INFO] __main__: Loaded 1 course(s) from manifest /data/output/_COURSES/manifest.json
2025-11-24 09:40:13,449 [INFO] __main__: Segmentation stage: using 1 parallel workers (device: gpu, detected_gpus=1, per-worker threads: resample=1, save=1)
2025-11-24 09:40:13,449 [INFO] __main__: Segmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:40:19,589 [INFO] rtpipeline.segmentation: TotalSegmentator output_type 'dicom_rtstruct' not supported by current CLI; skipping direct export
2025-11-24 09:40:19,589 [INFO] rtpipeline.segmentation: Running TotalSegmentator (nifti): TotalSegmentator -i /data/output/487009/2025-03/NIFTI/MIEDNICA_1_50_Qr40_S3_1.5_20250310.nii.gz -o /data/output/487009/2025-03/seg_3o3efw64/total/nifti -ot nifti --force_split -d gpu --nr_thr_resamp 1 --nr_thr_saving 1
2025-11-24 09:40:30,620 [ERROR] rtpipeline.segmentation: Command failed: TotalSegmentator -i /data/output/487009/2025-03/NIFTI/MIEDNICA_1_50_Qr40_S3_1.5_20250310.nii.gz -o /...
2025-11-24 09:40:30,620 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:30,622 [WARNING] __main__: Segmentation failed for /data/output/487009/2025-03: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:30,623 [INFO] __main__: Segmentation: 1/1 (100%) elapsed 17.2s ETA 0.0s
2025-11-24 09:40:31,812 [INFO] __main__: Loaded 1 course(s) from manifest /data/output/_COURSES/manifest.json
2025-11-24 09:40:31,813 [INFO] rtpipeline.custom_models: Discovered 2 custom model(s): HN_lymph_nodes, cardiac_STOPSTORM
2025-11-24 09:40:32,446 [INFO] __main__: Segmentation stage: using 1 parallel workers (device: gpu, detected_gpus=1, per-worker threads: resample=1, save=1)
2025-11-24 09:40:32,446 [INFO] __main__: Segmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:40:33,760 [INFO] rtpipeline.segmentation: TotalSegmentator output_type 'dicom_rtstruct' not supported by current CLI; skipping direct export
2025-11-24 09:40:33,760 [INFO] rtpipeline.segmentation: Running TotalSegmentator (nifti): TotalSegmentator -i /data/output/480007/2024-08/NIFTI/MIEDNICA_3.0_B31f_3_20240716.nii.gz -o /data/output/480007/2024-08/seg_109dxn_f/total/nifti -ot nifti --force_split -d gpu --nr_thr_resamp 1 --nr_thr_saving 1
2025-11-24 09:40:34,433 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:40:34,959 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:40:34,959 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:40:34,959 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:40:34,959 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:40:34,959 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:40:34,959 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:40:34,960 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:40:35,530 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:40:35,539 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 09:40:35,539 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:40:35,541 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:40:35,541 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:40:35,544 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:40:35,546 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:40:35,546 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:40:35,546 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:40:35,547 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:40:35,547 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:40:35,547 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:40:35,547 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:40:36,164 [ERROR] rtpipeline.segmentation: Command failed: TotalSegmentator -i /data/output/480007/2024-08/NIFTI/MIEDNICA_3.0_B31f_3_20240716.nii.gz -o /data/o...
2025-11-24 09:40:36,164 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:36,171 [WARNING] __main__: Segmentation failed for /data/output/480007/2024-08: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:36,171 [INFO] __main__: Segmentation: 1/1 (100%) elapsed 3.7s ETA 0.0s
2025-11-24 09:40:37,156 [INFO] __main__: Loaded 1 course(s) from manifest /data/output/_COURSES/manifest.json
2025-11-24 09:40:37,780 [INFO] __main__: Segmentation stage: using 1 parallel workers (device: gpu, detected_gpus=1, per-worker threads: resample=1, save=1)
2025-11-24 09:40:37,780 [INFO] __main__: Segmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:40:39,069 [INFO] rtpipeline.segmentation: TotalSegmentator output_type 'dicom_rtstruct' not supported by current CLI; skipping direct export
2025-11-24 09:40:39,069 [INFO] rtpipeline.segmentation: Running TotalSegmentator (nifti): TotalSegmentator -i /data/output/428459/2019-11/NIFTI/MIEDNICA_3.0_B31f_3_20191004.nii.gz -o /data/output/428459/2019-11/seg_w781v1mo/total/nifti -ot nifti --force_split -d gpu --nr_thr_resamp 1 --nr_thr_saving 1
2025-11-24 09:40:41,495 [ERROR] rtpipeline.segmentation: Command failed: TotalSegmentator -i /data/output/428459/2019-11/NIFTI/MIEDNICA_3.0_B31f_3_20191004.nii.gz -o /data/o...
2025-11-24 09:40:41,495 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:41,498 [WARNING] __main__: Segmentation failed for /data/output/428459/2019-11: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:41,498 [INFO] __main__: Segmentation: 1/1 (100%) elapsed 3.7s ETA 0.0s
2025-11-24 09:40:42,160 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:40:42,488 [INFO] __main__: Loaded 1 course(s) from manifest /data/output/_COURSES/manifest.json
2025-11-24 09:40:43,094 [INFO] __main__: Segmentation stage: using 1 parallel workers (device: gpu, detected_gpus=1, per-worker threads: resample=1, save=1)
2025-11-24 09:40:43,094 [INFO] __main__: Segmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:40:44,352 [INFO] rtpipeline.segmentation: TotalSegmentator output_type 'dicom_rtstruct' not supported by current CLI; skipping direct export
2025-11-24 09:40:44,352 [INFO] rtpipeline.segmentation: Running TotalSegmentator (nifti): TotalSegmentator -i /data/output/416435/2018-09/NIFTI/MIEDNICA_5.0_B31f_5_20180718.nii.gz -o /data/output/416435/2018-09/seg_u1pj3evp/total/nifti -ot nifti --force_split -d gpu --nr_thr_resamp 1 --nr_thr_saving 1
2025-11-24 09:40:46,767 [ERROR] rtpipeline.segmentation: Command failed: TotalSegmentator -i /data/output/416435/2018-09/NIFTI/MIEDNICA_5.0_B31f_5_20180718.nii.gz -o /data/o...
2025-11-24 09:40:46,767 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:46,771 [WARNING] __main__: Segmentation failed for /data/output/416435/2018-09: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:46,771 [INFO] __main__: Segmentation: 1/1 (100%) elapsed 3.7s ETA 0.0s
2025-11-24 09:40:47,744 [INFO] __main__: Loaded 1 course(s) from manifest /data/output/_COURSES/manifest.json
2025-11-24 09:40:48,385 [INFO] __main__: Segmentation stage: using 1 parallel workers (device: gpu, detected_gpus=1, per-worker threads: resample=1, save=1)
2025-11-24 09:40:48,385 [INFO] __main__: Segmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:40:49,717 [INFO] rtpipeline.segmentation: TotalSegmentator output_type 'dicom_rtstruct' not supported by current CLI; skipping direct export
2025-11-24 09:40:49,717 [INFO] rtpipeline.segmentation: Running TotalSegmentator (nifti): TotalSegmentator -i /data/output/480008/2024-09/NIFTI/MIEDNICA_3.0_B31f_3_20240716.nii.gz -o /data/output/480008/2024-09/seg_m_0b8ref/total/nifti -ot nifti --force_split -d gpu --nr_thr_resamp 1 --nr_thr_saving 1
2025-11-24 09:40:52,186 [ERROR] rtpipeline.segmentation: Command failed: TotalSegmentator -i /data/output/480008/2024-09/NIFTI/MIEDNICA_3.0_B31f_3_20240716.nii.gz -o /data/o...
2025-11-24 09:40:52,186 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:52,189 [WARNING] __main__: Segmentation failed for /data/output/480008/2024-09: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:52,189 [INFO] __main__: Segmentation: 1/1 (100%) elapsed 3.8s ETA 0.0s
2025-11-24 09:40:53,232 [INFO] __main__: Loaded 1 course(s) from manifest /data/output/_COURSES/manifest.json
2025-11-24 09:40:53,863 [INFO] __main__: Segmentation stage: using 1 parallel workers (device: gpu, detected_gpus=1, per-worker threads: resample=1, save=1)
2025-11-24 09:40:53,863 [INFO] __main__: Segmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:40:55,227 [INFO] rtpipeline.segmentation: TotalSegmentator output_type 'dicom_rtstruct' not supported by current CLI; skipping direct export
2025-11-24 09:40:55,228 [INFO] rtpipeline.segmentation: Running TotalSegmentator (nifti): TotalSegmentator -i /data/output/487009/2025-09/NIFTI/Respiratory_Motion_1_50_Qr40_S3_Average_CT_1.5_20250214.nii.gz -o /data/output/487009/2025-09/seg_rkrzp1jw/total/nifti -ot nifti --force_split -d gpu --nr_thr_resamp 1 --nr_thr_saving 1
2025-11-24 09:40:55,655 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:40:57,633 [ERROR] rtpipeline.segmentation: Command failed: TotalSegmentator -i /data/output/487009/2025-09/NIFTI/Respiratory_Motion_1_50_Qr40_S3_Average_CT_1.5...
2025-11-24 09:40:57,633 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:57,637 [WARNING] __main__: Segmentation failed for /data/output/487009/2025-09: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/TotalSegmentator", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/bin/TotalSegmentator.py", line 155, in main
    totalsegmentator(args.input, args.output, args.ml, args.nr_thr_resamp, args.nr_thr_saving,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/python_api.py", line 611, in totalsegmentator
    download_pretrained_weights(tid)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 385, in download_pretrained_weights
    download_url_and_unpack(WEIGHTS_URL, config_dir)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 130, in download_url_and_unpack
    raise e
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/totalsegmentator/libs.py", line 110, in download_url_and_unpack
    with open(tempfile, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 30] Read-only file system: '/home/rtpipeline/.totalsegmentator/nnunet/results/tmp_download_file.zip'

2025-11-24 09:40:57,637 [INFO] __main__: Segmentation: 1/1 (100%) elapsed 3.8s ETA 0.0s
2025-11-24 09:41:06,374 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:41:18,583 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:42:03,752 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:42:44,685 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:42:44,907 [INFO] __main__: Custom segmentation stage: using 1 parallel workers (detected_gpus=n/a)
2025-11-24 09:42:44,908 [INFO] __main__: CustomSegmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:42:45,006 [INFO] rtpipeline.custom_models: Running custom model 'HN_lymph_nodes' for patient 487009 course 2025-03
2025-11-24 09:42:45,832 [INFO] rtpipeline.custom_models: Copying weights for model HN_lymph_nodes network Task110_HNLNFixed_MirrorBest
2025-11-24 09:42:45,834 [INFO] rtpipeline.custom_models: Running nnUNet prediction: nnUNet_predict -i /data/output/487009/2025-03/custom_seg_HN_lymph_nodes_b1l7t7cm/input -o /data/output/487009/2025-03/custom_seg_HN_lymph_nodes_b1l7t7cm/output_3d_fullres -m 3d_fullres -t Task110_HNLNFixed_MirrorBest -f 0 -tr nnUNetTrainerV2 -ctr nnUNetTrainerV2CascadeFullRes -p nnUNetPlansv2.1
2025-11-24 09:42:49,003 [ERROR] rtpipeline.segmentation: Command failed: nnUNet_predict -i /data/output/487009/2025-03/custom_seg_HN_lymph_nodes_b1l7t7cm/input -o /data/outp...
2025-11-24 09:42:49,003 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:42:49,016 [WARNING] __main__: Custom segmentation failed for /data/output/487009/2025-03: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:42:49,017 [INFO] __main__: CustomSegmentation: 1/1 (100%) elapsed 4.1s ETA 0.0s
2025-11-24 09:42:50,080 [INFO] rtpipeline.custom_models: Discovered 2 custom model(s): HN_lymph_nodes, cardiac_STOPSTORM
2025-11-24 09:42:51,431 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:42:51,967 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:42:51,967 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:42:51,968 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:42:51,968 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:42:51,968 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:42:51,968 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:42:51,969 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:42:52,624 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:42:52,635 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:42:52,635 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:52,636 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:52,638 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:52,642 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:42:52,643 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:42:53,166 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:42:53,702 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:42:53,702 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:42:53,702 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:42:53,703 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:42:53,703 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:42:53,703 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:42:53,703 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:42:54,282 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 09:42:54,289 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:54,294 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:54,295 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:54,295 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:54,296 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:54,296 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:42:54,297 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:42:54,297 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:42:54,297 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:42:54,297 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:42:54,297 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:42:54,297 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:42:59,441 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:43:00,437 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:43:00,675 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:43:00,675 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:43:14,280 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:43:14,457 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:43:25,843 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:43:27,077 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:43:39,068 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:43:41,534 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:44:27,441 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:44:33,995 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:45:13,459 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:45:14,674 [INFO] __main__: CT_Cropping: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:45:14,678 [WARNING] __main__: CT cropping failed for /data/output/487009/2025-03: L1 vertebra not found in TotalSegmentator output - required for pelvic cropping. Available vertebrae: []
2025-11-24 09:45:14,679 [INFO] __main__: CT_Cropping: 1/1 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:18,949 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:45:18,949 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:45:18,949 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:45:18,949 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:45:20,543 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:45:20,544 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:45:21,125 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:45:21,126 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:45:21,126 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:45:21,127 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:45:21,127 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:45:21,127 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:45:21,127 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:45:21,127 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:45:21,742 [INFO] rtpipeline.organize: Organize: starting batch with 1 worker(s) for 6 task(s)
2025-11-24 09:45:21,750 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,757 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,763 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,763 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:45:21,768 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,770 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,772 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,773 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,774 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,776 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,777 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,777 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,777 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:45:21,778 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:45:21,778 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:45:21,778 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:45:21,778 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:45:21,778 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:45:21,780 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:21,780 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:45:21,780 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:45:21,780 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:45:21,781 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:45:21,781 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:45:21,781 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:45:21,945 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:45:21,986 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:45:22,229 [INFO] __main__: Custom segmentation stage: using 1 parallel workers (detected_gpus=n/a)
2025-11-24 09:45:22,230 [INFO] __main__: CustomSegmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:45:22,257 [INFO] rtpipeline.custom_models: Running custom model 'HN_lymph_nodes' for patient 416435 course 2018-09
2025-11-24 09:45:22,379 [INFO] rtpipeline.custom_models: Running nnUNet prediction: nnUNet_predict -i /data/output/416435/2018-09/custom_seg_HN_lymph_nodes_cuzz06j0/input -o /data/output/416435/2018-09/custom_seg_HN_lymph_nodes_cuzz06j0/output_3d_fullres -m 3d_fullres -t Task110_HNLNFixed_MirrorBest -f 0 -tr nnUNetTrainerV2 -ctr nnUNetTrainerV2CascadeFullRes -p nnUNetPlansv2.1
2025-11-24 09:45:22,600 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:45:22,600 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:45:22,600 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:45:22,600 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:45:22,601 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:45:22,601 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:45:22,602 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:45:23,262 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 09:45:23,275 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:45:23,276 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:23,276 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:23,277 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:23,279 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:23,280 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:23,280 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:45:23,280 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:45:23,280 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:45:23,280 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:45:23,280 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:45:23,281 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:45:25,357 [ERROR] rtpipeline.segmentation: Command failed: nnUNet_predict -i /data/output/416435/2018-09/custom_seg_HN_lymph_nodes_cuzz06j0/input -o /data/outp...
2025-11-24 09:45:25,358 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:45:25,362 [WARNING] __main__: Custom segmentation failed for /data/output/416435/2018-09: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:45:25,362 [INFO] __main__: CustomSegmentation: 1/1 (100%) elapsed 3.1s ETA 0.0s
2025-11-24 09:45:26,654 [INFO] rtpipeline.custom_models: Discovered 2 custom model(s): HN_lymph_nodes, cardiac_STOPSTORM
2025-11-24 09:45:27,375 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:45:27,981 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:45:27,981 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:45:27,981 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:45:27,981 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:45:27,982 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:45:27,982 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:45:27,982 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:45:28,646 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:45:28,654 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:28,655 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:28,658 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:28,659 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:28,661 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:28,663 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:28,663 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:45:28,663 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:45:28,663 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:45:28,663 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:45:28,663 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:45:28,664 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:45:29,402 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:45:29,452 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:45:30,056 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:45:30,677 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:45:30,677 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:45:30,678 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:45:30,678 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:45:30,679 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:45:30,679 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:45:30,679 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:45:31,399 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 09:45:31,414 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:45:31,414 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:31,415 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:31,415 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:31,416 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:31,417 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:45:31,417 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:45:31,417 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:45:31,418 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:45:31,418 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:45:31,418 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:45:31,418 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:45:34,242 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:45:37,935 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:45:40,287 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:45:40,540 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:45:40,540 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:45:48,011 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:45:48,263 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:45:58,674 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:45:59,324 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:46:00,291 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:46:06,185 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:46:06,263 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:46:17,859 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:46:17,935 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:46:19,236 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:46:26,310 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:46:26,578 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:46:37,999 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:46:38,388 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:46:40,955 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:47:36,512 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:47:37,575 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:47:48,277 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:47:54,046 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:48:01,489 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:48:41,228 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:48:41,553 [INFO] __main__: QC stage: using 1 parallel workers
2025-11-24 09:48:41,553 [INFO] __main__: QC: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:48:41,934 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:48:42,245 [INFO] __main__: DVH stage: using 4 parallel workers
2025-11-24 09:48:42,245 [INFO] __main__: DVH: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:48:52,111 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:48:52,430 [INFO] __main__: CT_Cropping: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:48:52,435 [WARNING] __main__: CT cropping failed for /data/output/416435/2018-09: L1 vertebra not found in TotalSegmentator output - required for pelvic cropping. Available vertebrae: []
2025-11-24 09:48:52,435 [INFO] __main__: CT_Cropping: 1/1 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:55,643 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:48:56,401 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:48:56,401 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:48:56,402 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:48:56,402 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:48:56,402 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:48:56,402 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:48:56,403 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:48:56,883 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:48:56,883 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:48:56,924 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:48:56,924 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:48:57,173 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 09:48:57,187 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:48:57,187 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:57,187 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:57,188 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:57,196 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:57,203 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:57,203 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:48:57,204 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:48:57,204 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:48:57,205 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:48:57,205 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:48:57,205 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:48:58,085 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:48:58,199 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:48:58,594 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:48:58,690 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:48:58,690 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:48:58,690 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:48:58,690 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:48:58,690 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:48:58,690 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:48:58,690 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:48:58,805 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:48:58,805 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:48:58,806 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:48:58,807 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:48:58,807 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:48:58,807 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:48:58,807 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:48:58,891 [INFO] __main__: Custom segmentation stage: using 1 parallel workers (detected_gpus=n/a)
2025-11-24 09:48:58,891 [INFO] __main__: CustomSegmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:48:59,007 [INFO] rtpipeline.custom_models: Running custom model 'HN_lymph_nodes' for patient 480008 course 2024-09
2025-11-24 09:48:59,310 [INFO] rtpipeline.custom_models: Running nnUNet prediction: nnUNet_predict -i /data/output/480008/2024-09/custom_seg_HN_lymph_nodes_twhoia7x/input -o /data/output/480008/2024-09/custom_seg_HN_lymph_nodes_twhoia7x/output_3d_fullres -m 3d_fullres -t Task110_HNLNFixed_MirrorBest -f 0 -tr nnUNetTrainerV2 -ctr nnUNetTrainerV2CascadeFullRes -p nnUNetPlansv2.1
2025-11-24 09:48:59,405 [INFO] rtpipeline.organize: Organize: starting batch with 1 worker(s) for 6 task(s)
2025-11-24 09:48:59,412 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,417 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,422 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,427 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,433 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,438 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,438 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:48:59,439 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:48:59,439 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:48:59,439 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:48:59,439 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:48:59,440 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:48:59,550 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:48:59,560 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:48:59,561 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,564 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,564 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,569 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,569 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:48:59,569 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:48:59,569 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:48:59,570 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:48:59,570 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:48:59,570 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:48:59,570 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:49:02,681 [ERROR] rtpipeline.segmentation: Command failed: nnUNet_predict -i /data/output/480008/2024-09/custom_seg_HN_lymph_nodes_twhoia7x/input -o /data/outp...
2025-11-24 09:49:02,681 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:49:02,688 [WARNING] __main__: Custom segmentation failed for /data/output/480008/2024-09: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:49:02,689 [INFO] __main__: CustomSegmentation: 1/1 (100%) elapsed 3.8s ETA 0.0s
2025-11-24 09:49:04,166 [INFO] rtpipeline.custom_models: Discovered 2 custom model(s): HN_lymph_nodes, cardiac_STOPSTORM
2025-11-24 09:49:05,054 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:49:05,726 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:49:05,726 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:49:05,727 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:49:05,727 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:49:05,727 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:49:05,727 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:49:05,727 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:49:06,451 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:49:06,464 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:49:06,464 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:49:06,465 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:49:06,467 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:49:06,472 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:49:06,473 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:49:06,473 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:49:06,473 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:49:06,473 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:49:06,473 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:49:06,474 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:49:06,474 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:49:08,280 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:49:09,920 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:49:10,287 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:49:11,983 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:49:12,380 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 09:49:12,380 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 09:49:12,381 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 09:49:13,152 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 09:49:13,153 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 09:49:13,153 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:49:16,379 [INFO] rtpipeline.dvh: Regenerating RS_custom.dcm for 2025-03
2025-11-24 09:49:17,453 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:49:19,001 [INFO] rtpipeline.quality_control: QC report saved to /data/output/487009/2025-03/qc_reports/qc_report_487009_2025-03.json
2025-11-24 09:49:19,001 [INFO] __main__: QC: 1/1 (100%) elapsed 37.4s ETA 0.0s
2025-11-24 09:49:31,704 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:49:31,840 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:49:32,355 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:49:40,120 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:49:52,330 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:49:52,582 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:49:54,671 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:49:58,658 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 09:49:58,659 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 09:49:58,659 [INFO] rtpipeline.radiomics_parallel: Processing 27 radiomics tasks with 6 workers for 2025-03
2025-11-24 09:50:00,210 [INFO] rtpipeline.custom_structures: Loaded 5 custom structure configurations
2025-11-24 09:50:00,210 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'iliac_vess' (requested: iliac_artery_left, iliac_artery_right, iliac_vena_left, iliac_vena_right). Available structures: Fiz Body, Jelita - PTV1, Nerka Lewa, Odbytnica - PTV1, Pecherz - PTV1, Rdzen, Watroba, m1, m2, m3
2025-11-24 09:50:00,211 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'iliac_area' (requested: iliac_vess). Available structures: Fiz Body, Jelita - PTV1, Nerka Lewa, Odbytnica - PTV1, Pecherz - PTV1, Rdzen, Watroba, m1, m2, m3
2025-11-24 09:50:00,211 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'pelvic_bones' (requested: sacrum, hip_left, hip_right, vertebrae_S1). Available structures: Fiz Body, Jelita - PTV1, Nerka Lewa, Odbytnica - PTV1, Pecherz - PTV1, Rdzen, Watroba, m1, m2, m3
2025-11-24 09:50:00,211 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'pelvic_bones_3mm' (requested: pelvic_bones). Available structures: Fiz Body, Jelita - PTV1, Nerka Lewa, Odbytnica - PTV1, Pecherz - PTV1, Rdzen, Watroba, m1, m2, m3
2025-11-24 09:50:00,211 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'bowel_bag' (requested: colon, small_bowel, duodenum). Available structures: Fiz Body, Jelita - PTV1, Nerka Lewa, Odbytnica - PTV1, Pecherz - PTV1, Rdzen, Watroba, m1, m2, m3
2025-11-24 09:50:02,179 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:50:10,931 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 09:50:18,104 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:50:18,380 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:50:21,700 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:50:32,940 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:51:59,299 [INFO] rtpipeline.dvh: DVH (Merged): Still processing... 6/34 completed (17.6%)
2025-11-24 09:52:03,041 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:52:04,647 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:52:16,985 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:52:30,379 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:53:01,287 [INFO] rtpipeline.dvh: DVH (Merged): Still processing... 29/34 completed (85.3%)
2025-11-24 09:53:36,534 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:53:37,077 [INFO] __main__: QC stage: using 1 parallel workers
2025-11-24 09:53:37,077 [INFO] __main__: QC: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:53:38,062 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:53:38,625 [INFO] __main__: DVH stage: using 4 parallel workers
2025-11-24 09:53:38,625 [INFO] __main__: DVH: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:53:43,740 [INFO] rtpipeline.quality_control: QC report saved to /data/output/416435/2018-09/qc_reports/qc_report_416435_2018-09.json
2025-11-24 09:53:43,740 [INFO] __main__: QC: 1/1 (100%) elapsed 6.7s ETA 0.0s
2025-11-24 09:53:44,846 [INFO] rtpipeline.dvh: Regenerating RS_custom.dcm for 2018-09
2025-11-24 09:53:51,939 [INFO] rtpipeline.custom_structures: Loaded 5 custom structure configurations
2025-11-24 09:53:51,939 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'iliac_vess' (requested: iliac_artery_left, iliac_artery_right, iliac_vena_left, iliac_vena_right). Available structures: CTV 1, CTV 2, Kosci, PTV 1, PTV 2, Pecherz, gl, gp, pecherz-ptv, rdzen
2025-11-24 09:53:51,940 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'iliac_area' (requested: iliac_vess). Available structures: CTV 1, CTV 2, Kosci, PTV 1, PTV 2, Pecherz, gl, gp, pecherz-ptv, rdzen
2025-11-24 09:53:51,941 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'pelvic_bones' (requested: sacrum, hip_left, hip_right, vertebrae_S1). Available structures: CTV 1, CTV 2, Kosci, PTV 1, PTV 2, Pecherz, gl, gp, pecherz-ptv, rdzen
2025-11-24 09:53:51,941 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'pelvic_bones_3mm' (requested: pelvic_bones). Available structures: CTV 1, CTV 2, Kosci, PTV 1, PTV 2, Pecherz, gl, gp, pecherz-ptv, rdzen
2025-11-24 09:53:51,941 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'bowel_bag' (requested: colon, small_bowel, duodenum). Available structures: CTV 1, CTV 2, Kosci, PTV 1, PTV 2, Pecherz, gl, gp, pecherz-ptv, rdzen
2025-11-24 09:53:53,475 [WARNING] __main__: DVH: task #1 (CourseOutput(patient_id='487009', course_key='1_3_12_2_1107_5_1_7_128362_30000025031007314302200000006', course_id='2025-03', course_start='2025-03', dirs=CourseDirs(root=PosixPath('/data/output/487009/2025-03'), dicom=PosixPath('/data/output/487009/2025-03/DICOM'), dicom_ct=PosixPath('/data/output/487009/2025-03/DICOM/CT'), dicom_mr=PosixPath('/data/output/487009/2025-03/MR'), dicom_rtplan=PosixPath('/data/output/487009/2025-03/DICOM/RTPLAN'), dicom_rtdose=PosixPath('/data/output/487009/2025-03/DICOM/RTDOSE'), dicom_rtstruct=PosixPath('/data/output/487009/2025-03/DICOM/RTSTRUCT'), dicom_related=PosixPath('/data/output/487009/2025-03/DICOM_related'), nifti=PosixPath('/data/output/487009/2025-03/NIFTI'), segmentation_original=PosixPath('/data/output/487009/2025-03/Segmentation_Original'), segmentation_totalseg=PosixPath('/data/output/487009/2025-03/Segmentation_TotalSegmentator'), segmentation_custom_models=PosixPath('/data/output/487009/2025-03/Segmentation_CustomModels'), metadata=PosixPath('/data/output/487009/2025-03/metadata'), qc_reports=PosixPath('/data/output/487009/2025-03/qc_reports')), rp_path=PosixPath('/data/output/487009/2025-03/RP.dcm'), rd_path=PosixPath('/data/output/487009/2025-03/RD.dcm'), rs_path=PosixPath('/data/output/487009/2025-03/RS.dcm'), primary_nifti=PosixPath('/data/output/487009/2025-03/NIFTI/MIEDNICA_1_50_Qr40_S3_1.5_20250310.nii.gz'), related_dicom=[], total_prescription_gy=61.99999999999921, plan_sop_uid='1.2.246.352.800.5753328909605547896.18278335225023112579', dose_sop_uid='1.2.246.352.800.4844045572705812994.6090101605343987111', source_plan_uids=['1.2.246.352.800.5753328909605547896.18278335225023112579'], source_dose_uids=[])) took 311.2s (slow)
2025-11-24 09:53:53,475 [INFO] __main__: DVH: Still processing... 1/1 completed (100.0%)
2025-11-24 09:53:53,475 [INFO] __main__: DVH: 1/1 (100%) elapsed 311.2s ETA 0.0s
2025-11-24 09:53:54,453 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:53:54,868 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 09:53:54,869 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 09:53:54,869 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 09:53:55,059 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 09:53:55,059 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 09:53:55,060 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:53:59,899 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 09:54:00,452 [INFO] __main__: Custom segmentation stage: using 1 parallel workers (detected_gpus=n/a)
2025-11-24 09:54:00,453 [INFO] __main__: CustomSegmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 09:54:00,589 [INFO] rtpipeline.custom_models: Running custom model 'HN_lymph_nodes' for patient 480007 course 2024-08
2025-11-24 09:54:00,866 [INFO] rtpipeline.custom_models: Running nnUNet prediction: nnUNet_predict -i /data/output/480007/2024-08/custom_seg_HN_lymph_nodes_zloqdyqa/input -o /data/output/480007/2024-08/custom_seg_HN_lymph_nodes_zloqdyqa/output_3d_fullres -m 3d_fullres -t Task110_HNLNFixed_MirrorBest -f 0 -tr nnUNetTrainerV2 -ctr nnUNetTrainerV2CascadeFullRes -p nnUNetPlansv2.1
2025-11-24 09:54:01,539 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 09:54:01,539 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 09:54:01,539 [INFO] rtpipeline.radiomics_parallel: Processing 22 radiomics tasks with 6 workers for 2018-09
2025-11-24 09:54:02,685 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 09:54:07,277 [ERROR] rtpipeline.segmentation: Command failed: nnUNet_predict -i /data/output/480007/2024-08/custom_seg_HN_lymph_nodes_zloqdyqa/input -o /data/outp...
2025-11-24 09:54:07,278 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:54:07,285 [WARNING] __main__: Custom segmentation failed for /data/output/480007/2024-08: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 09:54:07,285 [INFO] __main__: CustomSegmentation: 1/1 (100%) elapsed 6.8s ETA 0.0s
2025-11-24 09:54:10,647 [WARNING] dicompylercore.dvhcalc: Dose plane not found for -209.50. Using -617 to calculate contour volume.
2025-11-24 09:54:11,982 [WARNING] dicompylercore.dvhcalc: Dose plane not found for -209.50. Using -617 to calculate contour volume.
2025-11-24 09:54:14,656 [WARNING] dicompylercore.dvhcalc: Dose plane not found for -624.50. Using -617 to calculate contour volume.
2025-11-24 09:54:15,009 [WARNING] dicompylercore.dvhcalc: Dose plane not found for -624.50. Using -617 to calculate contour volume.
2025-11-24 09:54:18,069 [INFO] __main__: DVH: 1/1 (100%) elapsed 39.4s ETA 0.0s
2025-11-24 09:54:18,634 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:54:19,743 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:54:19,743 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:54:19,744 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:54:19,744 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:54:19,744 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:54:19,744 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:54:19,744 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:54:20,824 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 09:54:20,839 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:54:20,840 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:20,841 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:20,841 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:20,844 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:20,847 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:20,847 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:54:20,847 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:54:20,848 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:54:20,848 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:54:20,848 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:54:20,849 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:54:21,668 [INFO] rtpipeline.custom_models: Discovered 2 custom model(s): HN_lymph_nodes, cardiac_STOPSTORM
2025-11-24 09:54:22,908 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 09:54:23,864 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 09:54:23,864 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 09:54:23,865 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 09:54:23,866 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 09:54:23,866 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 09:54:23,867 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 09:54:23,867 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 09:54:25,081 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 09:54:25,093 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 09:54:25,094 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:25,098 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:25,100 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:25,103 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:25,105 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 09:54:25,105 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 09:54:25,105 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 09:54:25,106 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 09:54:25,106 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 09:54:25,106 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 09:54:25,107 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 09:54:40,814 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:54:41,332 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 09:54:41,332 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 09:54:44,166 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 09:55:04,626 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/22 (45.5%), ETA: 74.3s
2025-11-24 09:55:17,611 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:55:21,051 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 09:55:51,639 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:56:00,176 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 09:56:30,547 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:56:40,149 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 09:59:06,723 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 09:59:08,079 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 10:00:01,481 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/27 (37.0%), ETA: 1003.9s
2025-11-24 10:01:18,367 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 10:01:19,209 [INFO] __main__: Custom segmentation stage: using 1 parallel workers (detected_gpus=n/a)
2025-11-24 10:01:19,209 [INFO] __main__: CustomSegmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 10:01:19,383 [INFO] rtpipeline.custom_models: Running custom model 'HN_lymph_nodes' for patient 428459 course 2019-11
2025-11-24 10:01:19,701 [INFO] rtpipeline.custom_models: Running nnUNet prediction: nnUNet_predict -i /data/output/428459/2019-11/custom_seg_HN_lymph_nodes_ng3d9_12/input -o /data/output/428459/2019-11/custom_seg_HN_lymph_nodes_ng3d9_12/output_3d_fullres -m 3d_fullres -t Task110_HNLNFixed_MirrorBest -f 0 -tr nnUNetTrainerV2 -ctr nnUNetTrainerV2CascadeFullRes -p nnUNetPlansv2.1
2025-11-24 10:01:21,275 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 10:01:22,171 [INFO] __main__: CT_Cropping: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 10:01:22,178 [WARNING] __main__: CT cropping failed for /data/output/480007/2024-08: L1 vertebra not found in TotalSegmentator output - required for pelvic cropping. Available vertebrae: []
2025-11-24 10:01:22,179 [INFO] __main__: CT_Cropping: 1/1 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:26,788 [ERROR] rtpipeline.segmentation: Command failed: nnUNet_predict -i /data/output/428459/2019-11/custom_seg_HN_lymph_nodes_ng3d9_12/input -o /data/outp...
2025-11-24 10:01:26,788 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 10:01:26,800 [WARNING] __main__: Custom segmentation failed for /data/output/428459/2019-11: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 10:01:26,801 [INFO] __main__: CustomSegmentation: 1/1 (100%) elapsed 7.6s ETA 0.0s
2025-11-24 10:01:29,212 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 10:01:29,703 [INFO] rtpipeline.custom_models: Discovered 2 custom model(s): HN_lymph_nodes, cardiac_STOPSTORM
2025-11-24 10:01:30,860 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 10:01:30,860 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 10:01:30,861 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 10:01:30,861 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 10:01:30,861 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 10:01:30,862 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 10:01:30,862 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 10:01:31,700 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 10:01:32,266 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 10:01:32,266 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 10:01:32,422 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-24 10:01:32,422 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-24 10:01:32,776 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 10:01:32,793 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 10:01:32,793 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:32,795 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:32,796 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:32,806 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:32,815 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:32,816 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 10:01:32,816 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 10:01:32,817 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 10:01:32,817 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 10:01:32,817 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 10:01:32,818 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 10:01:33,263 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 10:01:33,263 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 10:01:33,263 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 10:01:33,264 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 10:01:33,264 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 10:01:33,265 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 10:01:33,265 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 10:01:34,979 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 10:01:34,994 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 10:01:34,996 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:34,997 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:34,998 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:35,005 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:35,006 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:35,006 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 10:01:35,007 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 10:01:35,007 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 10:01:35,007 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 10:01:35,008 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 10:01:35,009 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 10:01:35,217 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 10:01:35,464 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 10:01:36,566 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 10:01:36,566 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 10:01:36,567 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 10:01:36,567 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 10:01:36,568 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 10:01:36,568 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 10:01:36,568 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 10:01:37,087 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 10:01:37,088 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 10:01:37,088 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 10:01:37,088 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 10:01:37,089 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 10:01:37,089 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 10:01:37,089 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 10:01:38,419 [INFO] rtpipeline.organize: Organize: starting batch with 1 worker(s) for 6 task(s)
2025-11-24 10:01:38,428 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:38,436 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:38,445 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:38,453 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:38,463 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:38,470 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-24 10:01:38,471 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 10:01:38,471 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 10:01:38,471 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 10:01:38,472 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 10:01:38,472 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 10:01:38,472 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 10:01:39,104 [INFO] rtpipeline.organize: Organize: starting batch with 4 worker(s) for 6 task(s)
2025-11-24 10:01:39,119 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 10:01:39,121 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:39,123 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:39,130 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:39,133 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:39,134 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-24 10:01:39,134 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 10:01:39,135 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 10:01:39,135 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 10:01:39,136 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 10:01:39,136 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 10:01:39,137 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 10:01:57,688 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 10:02:01,798 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 10:02:03,047 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 10:02:05,119 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 10:02:44,186 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 10:02:49,700 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 10:02:51,779 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 10:02:54,249 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 10:03:28,716 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 10:03:29,085 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 10:03:33,935 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 10:03:34,309 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 10:04:18,158 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 10:04:19,332 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 10:04:20,476 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 10:04:20,616 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 10:07:00,050 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 10:07:11,701 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 10:07:27,077 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 10:07:27,664 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 10:09:32,171 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 10:09:34,575 [INFO] __main__: DVH stage: using 4 parallel workers
2025-11-24 10:09:34,576 [INFO] __main__: DVH: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 10:09:38,238 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 10:09:39,775 [INFO] __main__: Custom segmentation stage: using 1 parallel workers (detected_gpus=n/a)
2025-11-24 10:09:39,776 [INFO] __main__: CustomSegmentation: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 10:09:40,103 [INFO] rtpipeline.custom_models: Running custom model 'HN_lymph_nodes' for patient 487009 course 2025-09
2025-11-24 10:09:40,687 [INFO] rtpipeline.custom_models: Running nnUNet prediction: nnUNet_predict -i /data/output/487009/2025-09/custom_seg_HN_lymph_nodes_gvyc789d/input -o /data/output/487009/2025-09/custom_seg_HN_lymph_nodes_gvyc789d/output_3d_fullres -m 3d_fullres -t Task110_HNLNFixed_MirrorBest -f 0 -tr nnUNetTrainerV2 -ctr nnUNetTrainerV2CascadeFullRes -p nnUNetPlansv2.1
2025-11-24 10:09:47,332 [INFO] rtpipeline.dvh: Regenerating RS_custom.dcm for 2024-08
2025-11-24 10:09:50,930 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 10:09:51,514 [INFO] __main__: QC stage: using 1 parallel workers
2025-11-24 10:09:51,514 [INFO] __main__: QC: starting batch with 1 worker(s) for 1 task(s)
2025-11-24 10:09:56,034 [ERROR] rtpipeline.segmentation: Command failed: nnUNet_predict -i /data/output/487009/2025-09/custom_seg_HN_lymph_nodes_gvyc789d/input -o /data/outp...
2025-11-24 10:09:56,034 [ERROR] rtpipeline.segmentation: Error: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 10:09:56,047 [WARNING] __main__: Custom segmentation failed for /data/output/487009/2025-09: Command failed: Traceback (most recent call last):
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/bin/nnUNet_predict", line 10, in <module>
    sys.exit(main())
             ^^^^^^
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict_simple.py", line 219, in main
    predict_from_folder(model_folder_name, input_folder, output_folder, folds, save_npz, num_threads_preprocessing,
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/site-packages/nnunet/inference/predict.py", line 630, in predict_from_folder
    shutil.copy(join(model, 'plans.pkl'), output_folder)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 431, in copy
    copyfile(src, dst, follow_symlinks=follow_symlinks)
  File "/app/.snakemake/conda/7ddad841791b2d680702d4054598f57c_/lib/python3.11/shutil.py", line 256, in copyfile
    with open(src, 'rb') as fsrc:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/data/models/HN_lymph_nodes/nnUNet_results/nnUNet/3d_fullres/Task110_HNLNFixed_MirrorBest/nnUNetTrainerV2__nnUNetPlansv2.1/plans.pkl'

2025-11-24 10:09:56,047 [INFO] __main__: CustomSegmentation: 1/1 (100%) elapsed 16.3s ETA 0.0s
2025-11-24 10:09:57,806 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 10:09:59,770 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 10:09:59,771 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 10:09:59,771 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 10:10:00,252 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 10:10:00,252 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 10:10:00,253 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 10:10:03,974 [INFO] rtpipeline.custom_structures: Loaded 5 custom structure configurations
2025-11-24 10:10:03,975 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'iliac_vess' (requested: iliac_artery_left, iliac_artery_right, iliac_vena_left, iliac_vena_right). Available structures: PTV2, PTV2 - PTV1, Pecherz, Pecherz - PTV, Rdzen, Spojenie Lonowe, gl, gp, m1, m2
2025-11-24 10:10:03,976 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'iliac_area' (requested: iliac_vess). Available structures: PTV2, PTV2 - PTV1, Pecherz, Pecherz - PTV, Rdzen, Spojenie Lonowe, gl, gp, m1, m2
2025-11-24 10:10:03,977 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'pelvic_bones' (requested: sacrum, hip_left, hip_right, vertebrae_S1). Available structures: PTV2, PTV2 - PTV1, Pecherz, Pecherz - PTV, Rdzen, Spojenie Lonowe, gl, gp, m1, m2
2025-11-24 10:10:03,977 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'pelvic_bones_3mm' (requested: pelvic_bones). Available structures: PTV2, PTV2 - PTV1, Pecherz, Pecherz - PTV, Rdzen, Spojenie Lonowe, gl, gp, m1, m2
2025-11-24 10:10:03,978 [WARNING] rtpipeline.custom_structures: No usable source structures found for custom structure 'bowel_bag' (requested: colon, small_bowel, duodenum). Available structures: PTV2, PTV2 - PTV1, Pecherz, Pecherz - PTV, Rdzen, Spojenie Lonowe, gl, gp, m1, m2
2025-11-24 10:10:07,027 [INFO] rtpipeline.quality_control: QC report saved to /data/output/480007/2024-08/qc_reports/qc_report_480007_2024-08.json
2025-11-24 10:10:07,028 [INFO] __main__: QC: 1/1 (100%) elapsed 15.5s ETA 0.0s
2025-11-24 10:10:14,747 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 10:10:14,747 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 10:10:14,747 [INFO] rtpipeline.radiomics_parallel: Processing 23 radiomics tasks with 6 workers for 2024-08
2025-11-24 10:10:17,575 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 10:10:57,043 [INFO] __main__: DVH: Still processing... 1/1 completed (100.0%)
2025-11-24 10:10:57,044 [INFO] __main__: DVH: 1/1 (100%) elapsed 82.5s ETA 0.0s
2025-11-24 10:12:59,308 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/23 (43.5%), ETA: 210.2s
2025-11-24 10:16:51,911 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/23 (87.0%), ETA: 59.1s
2025-11-24 10:21:09,702 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/22 (90.9%), ETA: 162.7s
2025-11-24 10:38:04,852 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/27 (74.1%), ETA: 1005.9s
2025-11-24 13:37:12,980 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 13:37:12,980 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 13:37:13,563 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 13:37:13,563 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 13:37:13,563 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 13:37:13,564 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 13:37:13,564 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 13:37:13,564 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 13:37:13,564 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 13:37:14,199 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 13:37:14,199 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 13:37:14,230 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.2s
2025-11-24 13:37:14,230 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.2s
2025-11-24 13:37:14,241 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.1s
2025-11-24 13:37:14,241 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.1s
2025-11-24 13:37:14,246 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 13:37:14,247 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 13:37:14,250 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.1s ETA 0.0s
2025-11-24 13:37:14,251 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.1s ETA 0.0s
2025-11-24 13:37:14,266 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.1s ETA 0.0s
2025-11-24 13:37:14,266 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.1s ETA 0.0s
2025-11-24 13:37:14,280 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-24 13:37:14,280 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-24 13:37:14,281 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 13:37:14,281 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 13:37:14,281 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 13:37:14,281 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 13:37:14,282 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 13:37:22,695 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 13:37:22,719 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 13:37:42,207 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 13:37:42,241 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 13:37:57,293 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 13:37:57,329 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 13:38:14,141 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 13:38:14,176 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 13:39:14,992 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 13:39:15,497 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 13:40:11,292 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 13:40:11,782 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 13:40:12,634 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 13:40:12,634 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 13:40:12,634 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 13:40:12,634 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 13:40:12,634 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 13:40:12,634 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 13:40:12,791 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 13:40:12,791 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 13:40:12,792 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 13:40:12,792 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 13:40:12,791 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 13:40:12,792 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 13:40:18,166 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 13:40:18,166 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 13:40:18,166 [INFO] rtpipeline.radiomics_parallel: Processing 23 radiomics tasks with 6 workers for 2024-08
2025-11-24 13:40:19,457 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 13:40:46,588 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 13:40:46,588 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 13:40:46,588 [INFO] rtpipeline.radiomics_parallel: Processing 27 radiomics tasks with 6 workers for 2025-03
2025-11-24 13:40:56,773 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 13:41:58,460 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/23 (43.5%), ETA: 128.7s
2025-11-24 13:44:23,720 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/23 (87.0%), ETA: 36.6s
2025-11-24 13:48:30,069 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/27 (37.0%), ETA: 770.6s
2025-11-24 14:17:11,197 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/27 (74.1%), ETA: 761.0s
2025-11-24 17:38:24,096 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 17:38:24,096 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 17:38:24,687 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 17:38:24,687 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 17:38:24,687 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 17:38:25,323 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 17:38:25,323 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 17:38:25,352 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 17:38:25,353 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.1s
2025-11-24 17:38:25,360 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.1s
2025-11-24 17:38:25,360 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.1s
2025-11-24 17:38:25,360 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 17:38:25,360 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 17:38:25,371 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 17:38:25,371 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 17:38:25,385 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.1s ETA 0.0s
2025-11-24 17:38:25,385 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.1s ETA 0.0s
2025-11-24 17:38:25,395 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-24 17:38:25,395 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-24 17:38:25,395 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 17:38:25,395 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 17:38:25,396 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 17:38:34,061 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 17:38:34,096 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 17:38:53,009 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 17:38:53,051 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 17:39:07,886 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 17:39:07,926 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 17:39:24,156 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 17:39:24,411 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 17:40:23,496 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 17:40:24,209 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 17:41:19,759 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 17:41:19,811 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 17:41:21,152 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 17:41:21,152 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 17:41:21,152 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 17:41:21,152 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 17:41:21,152 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 17:41:21,152 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 17:41:21,517 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 17:41:21,518 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 17:41:21,518 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 17:41:21,518 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 17:41:21,518 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 17:41:21,519 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 17:41:26,812 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 17:41:26,812 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 17:41:26,812 [INFO] rtpipeline.radiomics_parallel: Processing 23 radiomics tasks with 6 workers for 2024-08
2025-11-24 17:41:28,086 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 17:41:54,705 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 17:41:54,705 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 17:41:54,705 [INFO] rtpipeline.radiomics_parallel: Processing 27 radiomics tasks with 6 workers for 2025-03
2025-11-24 17:42:05,678 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 17:43:10,462 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/23 (43.5%), ETA: 133.1s
2025-11-24 17:45:09,336 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/23 (87.0%), ETA: 33.2s
2025-11-24 17:49:22,261 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/27 (37.0%), ETA: 742.2s
2025-11-24 18:28:56,128 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/27 (74.1%), ETA: 983.7s
2025-11-24 23:39:39,856 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-24 23:39:40,412 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-24 23:39:40,412 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-24 23:39:40,412 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-24 23:39:40,412 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-24 23:39:40,412 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-24 23:39:40,412 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-24 23:39:40,412 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-24 23:39:41,020 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-24 23:39:41,056 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.2s
2025-11-24 23:39:41,061 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.1s
2025-11-24 23:39:41,062 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-24 23:39:41,068 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-24 23:39:41,089 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.1s ETA 0.0s
2025-11-24 23:39:41,107 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-24 23:39:41,108 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-24 23:39:41,108 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-24 23:39:41,108 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-24 23:39:41,108 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-24 23:39:41,109 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-24 23:39:41,109 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-24 23:39:49,100 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-24 23:40:05,973 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-24 23:40:18,655 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-24 23:40:32,924 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-24 23:41:26,338 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-24 23:42:13,868 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-24 23:42:15,139 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-24 23:42:15,139 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-24 23:42:15,140 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-24 23:42:15,598 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-24 23:42:15,598 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-24 23:42:15,598 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-24 23:42:18,885 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-24 23:42:18,885 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-24 23:42:18,885 [INFO] rtpipeline.radiomics_parallel: Processing 22 radiomics tasks with 6 workers for 2018-09
2025-11-24 23:42:19,631 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-24 23:42:58,444 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/22 (45.5%), ETA: 46.6s
2025-11-24 23:51:50,588 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 20/22 (90.9%), ETA: 57.1s
2025-11-24 23:55:27,321 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 22/22 (100.0%), ETA: 0.0s
2025-11-24 23:55:27,338 [INFO] rtpipeline.radiomics_parallel: Completed 22/22 radiomics extractions for 2018-09
2025-11-24 23:55:27,554 [WARNING] rtpipeline.radiomics: Radiomics (CT courses): task #1 (CourseOutput(patient_id='416435', course_key='1_3_12_2_1107_5_1_4_49619_30000018071808142450000000040', course_id='2018-09', course_start='2018-08-13', dirs=CourseDirs(root=PosixPath('/data/output/416435/2018-09'), dicom=PosixPath('/data/output/416435/2018-09/DICOM'), dicom_ct=PosixPath('/data/output/416435/2018-09/DICOM/CT'), dicom_mr=PosixPath('/data/output/416435/2018-09/MR'), dicom_rtplan=PosixPath('/data/output/416435/2018-09/DICOM/RTPLAN'), dicom_rtdose=PosixPath('/data/output/416435/2018-09/DICOM/RTDOSE'), dicom_rtstruct=PosixPath('/data/output/416435/2018-09/DICOM/RTSTRUCT'), dicom_related=PosixPath('/data/output/416435/2018-09/DICOM_related'), nifti=PosixPath('/data/output/416435/2018-09/NIFTI'), segmentation_original=PosixPath('/data/output/416435/2018-09/Segmentation_Original'), segmentation_totalseg=PosixPath('/data/output/416435/2018-09/Segmentation_TotalSegmentator'), segmentation_custom_models=PosixPath('/data/output/416435/2018-09/Segmentation_CustomModels'), metadata=PosixPath('/data/output/416435/2018-09/metadata'), qc_reports=PosixPath('/data/output/416435/2018-09/qc_reports')), rp_path=PosixPath('/data/output/416435/2018-09/RP.dcm'), rd_path=PosixPath('/data/output/416435/2018-09/RD.dcm'), rs_path=PosixPath('/data/output/416435/2018-09/RS.dcm'), primary_nifti=PosixPath('/data/output/416435/2018-09/NIFTI/MIEDNICA_5.0_B31f_5_20180718.nii.gz'), related_dicom=[PosixPath('/data/output/416435/2018-09/DICOM_related/REG/RE.416435.REGISTRATION.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 38.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 28.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 1.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 18.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 36.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 20.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 30.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 15.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 12.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 10.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 45.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 4.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 34.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 29.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 35.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 8.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 23.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 32.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 50.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 25.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 26.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 33.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 9.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 2.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 46.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 14.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 5.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 39.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 3.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 16.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 24.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 41.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 11.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 48.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 47.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 6.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 40.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 17.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 27.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 21.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 37.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 43.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 42.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 22.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 31.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 13.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 49.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 44.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 19.dcm'), PosixPath('/data/output/416435/2018-09/MR/1_2_410_200010_1_10110_53_1_1584989395_123/MR.416435.Image 7.dcm')], total_prescription_gy=50.4, plan_sop_uid='1.2.826.0.1.3680043.8.498.56638331812697347929712490146648443923', dose_sop_uid='1.2.826.0.1.3680043.8.498.82087536740177631632442410070050865290', source_plan_uids=['1.2.246.352.71.5.846132777028.948139.20180805125329', '1.2.246.352.71.5.846132777028.948143.20180805140542', '1.2.826.0.1.3680043.8.498.56638331812697347929712490146648443923'], source_dose_uids=['1.2.246.352.71.7.846132777028.2035418.20180806150448', '1.2.246.352.71.7.846132777028.2035427.20180806150900'])) took 792.0s (slow)
2025-11-24 23:55:27,554 [INFO] rtpipeline.radiomics: Radiomics (CT courses): Still processing... 1/1 completed (100.0%)
2025-11-24 23:55:27,554 [INFO] rtpipeline.radiomics: Radiomics (CT courses): 1/1 (100%) elapsed 792.0s ETA 0.0s
2025-11-25 00:49:35,433 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-25 00:49:36,090 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-25 00:49:36,090 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-25 00:49:36,090 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-25 00:49:36,090 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-25 00:49:36,090 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-25 00:49:36,090 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-25 00:49:36,090 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-25 00:49:36,662 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-25 00:49:36,741 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.1s ETA 0.4s
2025-11-25 00:49:36,746 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.1s ETA 0.2s
2025-11-25 00:49:36,754 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.1s ETA 0.1s
2025-11-25 00:49:36,763 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.1s ETA 0.1s
2025-11-25 00:49:36,768 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.1s ETA 0.0s
2025-11-25 00:49:36,772 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.1s ETA 0.0s
2025-11-25 00:49:36,773 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-25 00:49:36,773 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-25 00:49:36,773 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-25 00:49:36,773 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-25 00:49:36,773 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-25 00:49:36,773 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-25 00:49:44,258 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-25 00:49:44,500 [INFO] numexpr.utils: Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
2025-11-25 00:49:44,500 [INFO] numexpr.utils: NumExpr defaulting to 16 threads.
2025-11-25 00:49:58,635 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-25 00:50:12,403 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-25 00:50:25,847 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-25 00:51:13,553 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-25 00:51:55,293 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-25 00:51:56,500 [INFO] __main__: CT_Cropping: starting batch with 1 worker(s) for 1 task(s)
2025-11-25 00:51:56,504 [WARNING] __main__: CT cropping failed for /data/output/428459/2019-11: L1 vertebra not found in TotalSegmentator output - required for pelvic cropping. Available vertebrae: []
2025-11-25 00:51:56,504 [INFO] __main__: CT_Cropping: 1/1 (100%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:05,464 [INFO] rtpipeline.ct: Indexed CT series for 5 patients
2025-11-25 00:52:06,026 [INFO] rtpipeline.rt_details: Found RTPLAN=7, RTDOSE=7, RTSTRUCT=11
2025-11-25 00:52:06,026 [INFO] rtpipeline.metadata: Linked 7 Plan-Dose(-Struct) sets
2025-11-25 00:52:06,026 [INFO] rtpipeline.metadata: Patient 487009: 2 course(s) detected
2025-11-25 00:52:06,026 [INFO] rtpipeline.metadata: Patient 428459: 1 course(s) detected
2025-11-25 00:52:06,026 [INFO] rtpipeline.metadata: Patient 416435: 1 course(s) detected
2025-11-25 00:52:06,026 [INFO] rtpipeline.metadata: Patient 480007: 1 course(s) detected
2025-11-25 00:52:06,026 [INFO] rtpipeline.metadata: Patient 480008: 1 course(s) detected
2025-11-25 00:52:06,650 [INFO] rtpipeline.organize: Organize: starting batch with 6 worker(s) for 6 task(s)
2025-11-25 00:52:06,660 [INFO] rtpipeline.organize: Organize: 1/6 (17%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:06,662 [INFO] rtpipeline.organize: Organize: 2/6 (33%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:06,663 [INFO] rtpipeline.organize: Organize: 3/6 (50%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:06,663 [INFO] rtpipeline.organize: Organize: 4/6 (67%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organize: 5/6 (83%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organize: 6/6 (100%) elapsed 0.0s ETA 0.0s
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organized patient 416435 course 2018-09 at /data/output/416435/2018-09
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organized patient 428459 course 2019-11 at /data/output/428459/2019-11
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organized patient 480007 course 2024-08 at /data/output/480007/2024-08
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organized patient 480008 course 2024-09 at /data/output/480008/2024-09
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-03 at /data/output/487009/2025-03
2025-11-25 00:52:06,668 [INFO] rtpipeline.organize: Organized patient 487009 course 2025-09 at /data/output/487009/2025-09
2025-11-25 00:52:14,216 [INFO] rtpipeline.organize: [organize] 416435/2018-09 inferred total prescription=50.400
2025-11-25 00:52:30,422 [INFO] rtpipeline.organize: [organize] 428459/2019-11 inferred total prescription=50.000
2025-11-25 00:52:41,824 [INFO] rtpipeline.organize: [organize] 480007/2024-08 inferred total prescription=50.000
2025-11-25 00:52:54,790 [INFO] rtpipeline.organize: [organize] 480008/2024-09 inferred total prescription=60.000
2025-11-25 00:53:44,419 [INFO] rtpipeline.organize: [organize] 487009/2025-03 inferred total prescription=62.000
2025-11-25 00:54:29,471 [INFO] rtpipeline.organize: [organize] 487009/2025-09 inferred total prescription=27.000
2025-11-25 00:54:29,774 [INFO] rtpipeline.radiomics_parallel: Calculated optimal radiomics workers: 23 (CPU cores: 24, using: 23)
2025-11-25 00:54:29,774 [INFO] rtpipeline.radiomics_parallel: Enabled parallel radiomics processing with 23 optimal workers
2025-11-25 00:54:29,774 [INFO] __main__: Enabled parallel radiomics processing: 23 workers (cores-1), thread_limit=1
2025-11-25 00:54:30,670 [INFO] rtpipeline.radiomics: Using enhanced parallel radiomics implementation
2025-11-25 00:54:30,670 [INFO] rtpipeline.radiomics: Processing radiomics with up to 6 course workers
2025-11-25 00:54:30,671 [INFO] rtpipeline.radiomics: Radiomics (CT courses): starting batch with 1 worker(s) for 1 task(s)
2025-11-25 00:54:37,960 [ERROR] rtpipeline.dvh: Failed to import dicompylercore: No module named 'dicompylercore'. Install with: pip install dicompyler-core
2025-11-25 00:54:37,960 [WARNING] rtpipeline.radiomics_parallel: Failed to process custom structures for radiomics: No module named 'dicompylercore'
2025-11-25 00:54:37,960 [INFO] rtpipeline.radiomics_parallel: Processing 17 radiomics tasks with 6 workers for 2019-11
2025-11-25 00:54:39,201 [INFO] rtpipeline.radiomics_parallel: Using parallel radiomics processing with 6 workers (CPU cores: 24)
2025-11-25 00:55:32,244 [INFO] rtpipeline.radiomics_parallel: Radiomics progress: 10/17 (58.8%), ETA: 37.1s
